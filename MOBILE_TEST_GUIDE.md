# 移动端测试指南

## 问题诊断步骤

### 1. 检查音频文件是否正确部署
在浏览器中直接访问：
- `https://your-domain.vercel.app/audio/心经.mp3`
- `https://your-domain.vercel.app/audio/tone_singing_bowl.mp3`

如果返回404错误，说明音频文件没有正确部署。

### 2. 检查控制台错误
在移动端浏览器中：
1. 打开开发者工具（如果支持）
2. 查看控制台是否有错误信息
3. 特别关注音频加载和播放相关的错误

### 3. 检查用户交互
确保：
1. 点击了"点击开始"按钮
2. 用户交互状态正确更新
3. 遮罩层正确隐藏

## 修复的关键问题

### 1. iOS音频播放限制
- ✅ 改为先后播放，不再同时播放两个音频
- ✅ 添加了详细的错误处理和日志
- ✅ 确保用户交互后才能播放音频

### 2. 移动端UI显示
- ✅ 修复了AutoPlayGuard的显示逻辑
- ✅ 添加了调试信息显示
- ✅ 优化了移动端样式

### 3. 音频播放流程
```
用户点击 → 播放引入音频 → 引入音频结束 → 播放主音频
```

## 测试步骤

### 1. 本地测试
```bash
npm run build
npm run preview
```
然后在手机浏览器中访问 `http://你的IP:4173`

### 2. 部署后测试
1. 访问部署的URL
2. 点击"点击开始"按钮
3. 等待引入音频播放完成
4. 检查主音频是否开始播放
5. 检查播放器UI是否显示

### 3. 调试信息
在开发模式下，页面左上角会显示调试信息：
- User: 用户是否已交互
- Ready: 音频是否就绪
- Playing: 主音频是否播放
- Intro: 引入音频是否播放
- Audio: 音频文件路径

## 常见问题解决

### 问题1：看不到播放器
**原因：** AutoPlayGuard遮罩没有正确隐藏
**解决：** 确保点击了"点击开始"按钮，检查控制台日志

### 问题2：音频不播放
**原因：** 
- 音频文件路径错误
- 移动端浏览器限制
- 网络问题

**解决：**
1. 检查音频文件是否正确部署
2. 确保用户交互后播放
3. 检查网络连接

### 问题3：只听到提示音，心经不播放
**原因：** iOS不支持同时播放多个音频
**解决：** 已修复为先后播放模式

## 部署检查清单

- [ ] 音频文件已正确部署到 `/audio/` 目录
- [ ] 构建产物包含所有必要文件
- [ ] Vercel配置正确
- [ ] 移动端meta标签已添加
- [ ] CSS样式包含移动端优化
- [ ] 音频播放逻辑已修复为先后播放

## 性能优化建议

1. **音频文件优化**
   - 确保音频文件格式兼容
   - 控制文件大小
   - 使用适当的比特率

2. **加载优化**
   - 预加载关键资源
   - 使用适当的缓存策略
   - 优化首屏加载时间

3. **用户体验优化**
   - 添加加载指示器
   - 优化触摸交互
   - 提供错误处理机制
